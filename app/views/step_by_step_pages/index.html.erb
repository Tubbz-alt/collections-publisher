<%
  links = [
    {
      text: 'Step by step publisher',
    }
  ]
%>

<%= render 'shared/steps/step_breadcrumb', links: links %>

<%= render 'shared/steps/page_title', links: links %>

<%= render 'shared/steps/form_notice', message: notice, status: "success" %>

<h1>Step by step navigation publisher</h1>

<div class="row step-actions">
  <div class="col-xs-6 col-md-6">
    <%= link_to 'Create new', new_step_by_step_page_path, class: "btn btn-primary" %>
  </div>

  <div class="col-xs-6 col-md-6">
    <div class="dropdown pull-right">
      <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Filter by status
        <span class="caret"></span>
      </button>

      <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" id="filterStatus">
        <li><a href="#" data-show="all">All</a></li>
        <li><a href="#" data-show="draft">Draft</a></li>
        <li><a href="#" data-show="live">Live</a></li>
        <li><a href="#" data-show="unpublished_changes">Unpublished changes</a></li>
      </ul>
    </div>
  </div>
</div>

<table class="table table-striped" data-module="filterable-table">
  <thead>
    <tr>
      <th colspan="4">
        <div class='filter-control'>
          <%= render partial: 'govuk_admin_template/table_filter_form', locals: { placeholder: 'Search for a step by step page here' } %>
        </div>
      </th>
    </tr>
    <tr>
      <th>Title</th>
      <th>Actions</th>
      <th>Slug</th>
      <th class="text-right">Status</th>
    </tr>
  </thead>

  <tbody>
    <% @step_by_step_pages.each do |step_by_step_page| %>
      <tr data-status="<%= step_by_step_page.status[:name] %>">
        <th>
          <%= step_by_step_page.title %>
        </th>
        <td>
          <ul class="list-inline">
            <li><%= link_to 'Edit', step_by_step_page %></li>
            <li><%= link_to 'Choose navigation', step_by_step_page_navigation_rules_path(step_by_step_page) %></li>
            <% if step_by_step_page.has_draft? %>
                <li><%= link_to 'Preview', preview_url(step_by_step_page.slug, auth_bypass_id: step_by_step_page.auth_bypass_id) %></li>
            <% end %>
          </ul>
        </td>
        <td>
          <%= step_by_step_page.slug %>
        </td>
        <td class="text-right">
          <span class="h4">
            <span class="label <%= step_by_step_page.status[:label_class] %>" title="<%= step_by_step_page.status[:text] %>"><%= step_by_step_page.status[:text] %></span>
          </span>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
